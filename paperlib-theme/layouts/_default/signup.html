{{ define "main" }}

{{ "<!-- Blog Section Start -->" | safeHTML }}

<section class="section">
    <div class="container">
        <div class="row justify-content-md-center mb-3 mt-5">
            <div class="col-md-12" style="text-align: center;">
                <h2>{{ .Title }}</h2>
                <span class="border divider" style="border: none !important;"></span>
            </div>
        </div>
        <form class="row justify-content-center" id="signup-form" method="POST">
            <input type="text" placeholder="Email" name="email" required class="col-3 user-input-box mb-3" style="text-align: center; min-width: 250px;">
            <div class="w-100"></div>
            <input type="password" placeholder="Password" name="password" required class="col-3 user-input-box mb-3" style="text-align: center; min-width: 250px;">
            <div class="w-100"></div>
            <div class="col-3 mb-3" id="signup-response-info"></div>
            <div class="w-100"></div>
            <button type="submit" class="btn btn-main col-3">{{ .Site.Params.signin.registerText }}</button>
        </form>
    </div>
</section>

{{ end }}

{{ define "head" }}

<head>
    <script
        src="https://www.google.com/recaptcha/enterprise.js?render=6Lf3QJweAAAAAGh7PyVgrd105arPlhfE3NvWFUV7"></script>
</head>

{{ end }}

{{ define "script" }}

<script>

    $("#signup-form").submit(function (e) {
        e.preventDefault();
        grecaptcha.enterprise.ready(function () {
            grecaptcha.enterprise.execute('6Lf3QJweAAAAAGh7PyVgrd105arPlhfE3NvWFUV7', { action: 'login' }).then(function (token) {
                $("#signup-response-info").html("");

                $.ajax({
                    url: '/api/auth/signup',
                    type: 'POST',
                    data: {
                        email: $("#signup-form input[name='email']").val(),
                        password: $("#signup-form input[name='password']").val(),
                        recaptchaToken: token
                    },
                    success: function (response) {
                        $("#signup-response-info").html(response.message);
                    }
                });
            });
        });
    });

</script>

{{ end }}